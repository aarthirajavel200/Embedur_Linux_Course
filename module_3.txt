#!/bin/bash

1. Command-line arguments

SRC_DIR="$1"
BACKUP_DIR="$2"
EXT="$3"

# Check arguments count
if [ "$#" -ne 3 ]; then
    echo "Usage: $0 <source_dir> <backup_dir> <extension>"
    exit 1
fi


 2. Check source directory

if [ ! -d "$SRC_DIR" ]; then
    echo "Error: Source directory does not exist"
    exit 1
fi


3. Create backup directory

if [ ! -d "$BACKUP_DIR" ]; then
    mkdir -p "$BACKUP_DIR" || {
        echo "Error: Failed to create backup directory"
        exit 1
    }
fi


 4. Globbing + Array

FILES=("$SRC_DIR"/*"$EXT")

# If no matching files
if [ ! -e "${FILES[0]}" ]; then
    echo "No files with extension $EXT found"
    exit 0
fi


 5. Export environment variable

export BACKUP_COUNT=0
TOTAL_SIZE=0

echo "Files to be backed up:"
echo "----------------------"

6. Backup operation

for file in "${FILES[@]}"; do
    filename=$(basename "$file")
    dest="$BACKUP_DIR/$filename"

    size=$(stat -c %s "$file")
    echo "$filename - $size bytes"

    # If file exists in backup dir
    if [ -e "$dest" ]; then
        if [ "$file" -nt "$dest" ]; then
            cp "$file" "$dest"
        fi
    else
        cp "$file" "$dest"
    fi

    BACKUP_COUNT=$((BACKUP_COUNT + 1))
    TOTAL_SIZE=$((TOTAL_SIZE + size))
done

 
7. Report generation

REPORT="$BACKUP_DIR/backup_report.log"

{
    echo "Backup Summary Report"
    echo "---------------------"
    echo "Total files backed up : $BACKUP_COUNT"
    echo "Total size backed up  : $TOTAL_SIZE bytes"
    echo "Backup directory      : $BACKUP_DIR"
    echo "Date                  : $(date)"
} > "$REPORT"

echo "Backup completed successfully"
echo "Report saved at $REPORT"


To run this :  ./backup_manager.sh /home/user/source /home/user/backup .txt
